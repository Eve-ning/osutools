#' Simulates the Models through types
#'
#' @param m.jck model generated by model.jackInv
#' @param m.mtn model generated by model.motion
#' @param m.dns model generated by model.density
#'
#'
#' @importFrom magrittr %<>%
#' @importFrom dplyr mutate arrange bind_rows
#' @importFrom rlang .data
#' @export

model.sim <- function(m.jck, m.mtn, m.dns){

  model <- merge(m.jck, m.mtn, by='offsets')
  model %<>% merge(m.dns, by='offsets')


  # # Allocate columns in advance
  # chart %<>%
  #   dplyr::arrange(.data$offsets)
  #
  # # Chart frame is required to pad out decay calculations
  # # where there aren't spikes.
  # chart.frame <- data.frame(offsets=unique(chart$offsets))
  #
  # # We will be looping through the chart by key
  # chart.k.split <- split(x = chart, f = chart$keys)
  #
  # for (key in 1:length(chart.k.split)){
  #   chart.k <- chart.k.split[[key]]
  #   chart.k %<>%
  #     merge(chart.frame, by='offsets', all=T) %>%
  #     dplyr::mutate(is.spike = !is.na(.data$types))
  #
  #   chart.k.sim <- .cppSimulateKey(
  #     chart.k$offsets,
  #     chart.k$types,
  #     decay_ms = decay.ms,
  #     stress = 0
  #   )
  #
  #   chart.k.sim %<>%
  #     dplyr::mutate(keys = key)
  #
  #   chart.k.split[[key]] <- chart.k.sim
  # }
  #
  # # Join charts of different keys into one
  # chart <- dplyr::bind_rows(chart.k.split)
  # return(chart)
}
