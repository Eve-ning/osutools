#' Extracts chart details to use with Models
#'
#' @description This acts as a wrapper for more
#' detailed functions. Outputs chart.ext.
#'
#' @param chart Chart generated by chartParse
#' @param chart.keyset.select Read ?createMoveMapping
#' for more details
#' @param chart.keyset Read ?createMoveMapping
#' for more details
#' @param ignore.types Types of notes to ignore
#'
#' ?diffBroadcast for more details
#' @return Returns a data.frame compatible with
#' models
#' @export
chartExtract <- function(chart,
                         chart.keyset.select = NA,
                         chart.keyset = NA,
                         ignore.types = c('lnotel')) {
  chart.bcst <- diffBroadcast(chart, ignore.types = ignore.types)
  chart.ext <- merge(chart.bcst,
                     chartFngMapping(
                       chart.keyset.select = chart.keyset.select,
                       chart.keyset = chart.keyset,
                       include.details = T
                     ),
                     by = c('keys.froms', 'keys.tos'))
  return(chart.ext)
}
